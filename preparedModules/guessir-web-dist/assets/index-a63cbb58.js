var R=Object.defineProperty;var I=(r,e,t)=>e in r?R(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var o=(r,e,t)=>(I(r,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();var w=(r=>(r.Word="w",r.SpecialCharacter="sc",r.Letter="l",r.WordHelping="wh",r))(w||{});const m=class{static syncCase(e,t){return t[0]!==e[0]&&t[0].toUpperCase()===e[0]&&(t=t[0].toUpperCase()+t.substring(1)),t}static convertNormalizedPrimitiveLexeme(e,t){const s=m.NORMALIZED_WORDS_TO_NORMALIZED_WORDS.get(t)||t;return this.syncCase(e,s)}static normalizeCharacter(e){const t=e.toLowerCase();return m.CHARACTERS_TO_NORMALIZED_CHARACTERS.get(t)||t}static uncontractPrimitiveLexeme(e){const t=m.NORMALIZED_CONTRACTION_TO_NORMALIZED_NORMAL.get(e.toLowerCase());return t?this.syncCase(e,t):e}static isWordCharacter(e){if(e.length!==1)throw new Error("Can be used only for characters");return m.isLetter(e)||m.isWordHelpingCharacter(e)}static isLetter(e){return m.LETTER_RE.test(e)}static isWordHelpingCharacter(e){return m.NORMALIZED_CONTRACTION_CHARACTERS.includes(e)||m.NORMALIZED_WORD_SEPARATION_CHARACTERS.includes(e)}static getLexemeType(e){return e.normalized.length===1?m.isWordHelpingCharacter(e.normalized)?w.WordHelping:m.isLetter(e.normalized)?w.Letter:w.SpecialCharacter:w.Word}static getGroupingWords(e){const t=e.length,s=e.toLowerCase();return["s","d"].includes(s[t-1])&&s[t-2]==="'"?[s.slice(0,-2),s]:[s]}static isLexemeOtherCharacter(e){return e.type===w.SpecialCharacter||e.type===w.WordHelping}};let h=m;o(h,"CHARACTERS_TO_NORMALIZED_CHARACTERS",new Map([["—","-"],["’","'"],["`","'"]])),o(h,"NORMALIZED_WORDS_TO_NORMALIZED_WORDS",new Map([["i","I"]])),o(h,"NORMALIZED_CONTRACTION_CHARACTERS",["'"]),o(h,"NORMALIZED_WORD_SEPARATION_CHARACTERS",["-"]),o(h,"LETTER_RE",/^[A-Za-z]$/),o(h,"NORMALIZED_CONTRACTION_TO_NORMALIZED_NORMAL",new Map([["don't","do not"],["doesn't","does not"],["didn't","did not"],["haven't","have not"],["hadn't","had not"],["shouldn't","should"],["wouldn't","would not"],["couldn't","could not"],["mustn't","must not"],["can't","cannot"],["needn't","need not"],["won't","will not"],["I'm","I am"],["I've","I have"],["I'll","I will"],["she'll","she will"],["he'll","he will"],["we're","we are"],["we've","we have"],["we'll","we will"],["they're","they are"],["they've","they have"],["they'll","they will"]]));const b=class{constructor(){o(this,"lexemes",new Map);o(this,"lexemesByWordLike",new Map);o(this,"wordLikeCount",0);o(this,"otherCharacterCount",0);o(this,"lastLexemeIndex",-1)}analyze(e){const t=e.trim();let s="",n="",i;for(let u=0,f=t.length;u<f;u++){let E=!1;const g=t[u],x=h.normalizeCharacter(g);if(i===void 0&&(i=u),h.isWordCharacter(x)){const v=t[u+1]===void 0?void 0:h.normalizeCharacter(t[u+1]),S=v===void 0||!h.isWordCharacter(v);s=s+g,n=n+x,E=S,S&&(n=h.convertNormalizedPrimitiveLexeme(s,n))}else s=g,n=x,E=!0;E&&(this.processPrimitiveLexeme(s,n,i,u),i=void 0,s="",n="")}const l=this.lexemes,c=this.lexemesByWordLike,a=this.wordLikeCount,d=this.otherCharacterCount;return this.lexemes=new Map,this.lexemesByWordLike=new Map,this.wordLikeCount=0,this.otherCharacterCount=0,this.lastLexemeIndex=-1,{lexemes:l,lexemesByWordLike:c,wordLikeCount:a,otherCharacterCount:d}}processPrimitiveLexeme(e,t,s,n,i={}){const{onCreated:l}=i,c={endIndex:n,startIndex:s,original:e,normalized:t,uncontracted:h.uncontractPrimitiveLexeme(t)},a={...c,type:h.getLexemeType(c)};if(a.uncontracted!==a.normalized){this.splitUncontractedLexeme(a,s,n);return}const d=this.isLastLexemesMatch(1,E=>E.normalized===" "),u=b.PUNCTUATION_CHARACTERS.includes(a.normalized),f=a.normalized===`
`;if((d&&u||d&&f)&&this.deleteLastLexemes(E=>E.normalized===" "),this.canAddLexeme(a)){const E=++this.lastLexemeIndex;this.lexemes.set(E,a),h.isLexemeOtherCharacter(a)?this.otherCharacterCount++:(this.wordLikeCount++,h.getGroupingWords(a.normalized).forEach(g=>{const x=this.lexemesByWordLike.get(g)||new Map;x.set(E,a),this.lexemesByWordLike.set(g,x)})),l&&l(a)}}splitUncontractedLexeme(e,t,s){const n=e.uncontracted.split(" "),i=l=>l.uncontracted=e.uncontracted;n.forEach((l,c)=>{this.processPrimitiveLexeme(e.original,h.convertNormalizedPrimitiveLexeme(e.original,l),t,s,{onCreated:i}),c<n.length-1&&this.processPrimitiveLexeme(" "," ",t,s,{onCreated:i})})}canAddLexeme(e){return this.lexemes.get(this.lastLexemeIndex)?!(e.normalized===`
`&&this.isLastLexemesMatch(2,n=>n.normalized===`
`)||e.normalized===" "&&this.isLastLexemesMatch(1,n=>n.normalized===" ")):e.type===w.Word||e.type===w.Letter}isLastLexemesMatch(e,t){let s=this.lastLexemeIndex;for(;e>0;){const n=this.lexemes.get(s);if(!n||!t(n))return!1;s--,e--}return!0}deleteLastLexemes(e){let t=this.lexemes.get(this.lastLexemeIndex);for(;t&&e(t);)h.isLexemeOtherCharacter(t)?this.otherCharacterCount--:(this.wordLikeCount--,h.getGroupingWords(t.normalized).forEach(s=>{const n=this.lexemesByWordLike.get(s)||new Map;n.delete(this.lastLexemeIndex),n.size||this.lexemesByWordLike.delete(s)})),this.lexemes.delete(this.lastLexemeIndex),this.lastLexemeIndex--,t=this.lexemes.get(this.lastLexemeIndex);return!0}};let C=b;o(C,"PUNCTUATION_CHARACTERS",[",",".","!","?",";"]);class p{constructor(){o(this,"subscribers",new Set);o(this,"event",{subscribe:e=>this.subscribe(e),unsubscribe:e=>this.unsubscribe(e)})}publish(e){this.subscribers.forEach(t=>t(e))}subscribe(e){if(this.subscribers.has(e))throw new Error("Provided subscriber is already subscribed");this.subscribers.add(e)}unsubscribe(e){this.subscribers.delete(e)}}const T=(r,e,t={})=>{r.addEventListener("keypress",s=>{s.key!=="Enter"&&s.key!=="NumpadEnter"||(t.toggleChecked&&(r.checked=!r.checked),e(s))})},L=(r,e,t={})=>{r.addEventListener("change",s=>{e(s)}),T(r,e,t)};class k{constructor(e={}){o(this,"containerElement");o(this,"guessPubSub",new p);o(this,"showFirstLettersPubSub",new p);o(this,"showTextPubSub",new p);o(this,"isTextShown",!1);o(this,"isFirstLettersShown",!1);o(this,"guessEvent",this.guessPubSub.event);o(this,"showFirstLettersEvent",this.showFirstLettersPubSub.event);o(this,"showTextEvent",this.showTextPubSub.event);const{allowShowingFirstLetters:t,allowShowingText:s}=e;this.containerElement=document.createElement("div"),this.containerElement.id="controls-container",this.initElement(s,t)}getElement(){return this.containerElement}cleanAndFocusGuessInput(){const{guessInputElement:e}=this.getElements();e.value="",e.focus()}shakeAndError(){const{guessInputElement:e}=this.getElements();e.classList.add("shake-and-error");const t=()=>{e.removeEventListener("animationend",t),e.classList.remove("shake-and-error")};e.addEventListener("animationend",t)}initElement(e,t){var i,l;this.containerElement.innerHTML=`
      <input id="guess-input" type="text" />
      <button title="Please, input at least one letter to try to guess!" disabled id="guess-button" type="button">Guess</button>
      <label>
        <input type="checkbox" id="show-text-checkbox" /> Show text
      </label>
      <label>
        <input type="checkbox" id="show-first-letters-checkbox"> Show first letters
      </label>
    `;const{showTextCheckboxElement:s,showFirstLettersCheckboxElement:n}=this.getElements();e||(i=s.parentElement)==null||i.classList.add("hide"),t||(l=n.parentElement)==null||l.classList.add("hide"),this.attachGuessHandler(),this.attachShowFirstLettersHandler(),this.attachShowTextHandler(),this.attachInputHandler()}getElements(){const e=this.containerElement.querySelector("#show-text-checkbox"),t=this.containerElement.querySelector("#show-first-letters-checkbox"),s=this.containerElement.querySelector("#guess-button"),n=this.containerElement.querySelector("#guess-input");return{showTextCheckboxElement:e,showFirstLettersCheckboxElement:t,guessButtonElement:s,guessInputElement:n}}getInputtedWord(){const{guessInputElement:e}=this.getElements();return e.value.trim().toLowerCase()}attachInputHandler(){const{guessInputElement:e,guessButtonElement:t}=this.getElements();e.addEventListener("input",()=>{this.getInputtedWord()?t.disabled=!1:t.disabled=!0})}attachGuessHandler(){const{guessButtonElement:e,guessInputElement:t}=this.getElements(),s=()=>{const n=this.getInputtedWord();n&&this.guessPubSub.publish({word:n})};e.addEventListener("click",s),T(t,s)}attachShowTextHandler(){const{showTextCheckboxElement:e,showFirstLettersCheckboxElement:t}=this.getElements();L(e,()=>{this.isFirstLettersShown&&t.dispatchEvent(new Event("change")),this.isTextShown=!this.isTextShown,e.checked=this.isTextShown,this.showTextPubSub.publish(this.isTextShown)})}attachShowFirstLettersHandler(){const{showTextCheckboxElement:e,showFirstLettersCheckboxElement:t}=this.getElements();L(t,()=>{this.isTextShown&&e.dispatchEvent(new Event("change")),this.isFirstLettersShown=!this.isFirstLettersShown,t.checked=this.isFirstLettersShown,this.showFirstLettersPubSub.publish(this.isFirstLettersShown)})}}const A='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path d="M18 21H12C11.2044 21 10.4413 20.6839 9.87868 20.1213C9.31607 19.5587 9 18.7956 9 18V12C9 11.2044 9.31607 10.4413 9.87868 9.87868C10.4413 9.31607 11.2044 9 12 9H18C18.7956 9 19.5587 9.31607 20.1213 9.87868C20.6839 10.4413 21 11.2044 21 12V18C21 18.7956 20.6839 19.5587 20.1213 20.1213C19.5587 20.6839 18.7956 21 18 21ZM12 11C11.7348 11 11.4804 11.1054 11.2929 11.2929C11.1054 11.4804 11 11.7348 11 12V18C11 18.2652 11.1054 18.5196 11.2929 18.7071C11.4804 18.8946 11.7348 19 12 19H18C18.2652 19 18.5196 18.8946 18.7071 18.7071C18.8946 18.5196 19 18.2652 19 18V12C19 11.7348 18.8946 11.4804 18.7071 11.2929C18.5196 11.1054 18.2652 11 18 11H12Z" fill="#C7C7C7"></path><path d="M9.73 15H5.67C4.96268 14.9974 4.28509 14.7152 3.78494 14.2151C3.28478 13.7149 3.00263 13.0373 3 12.33V5.67C3.00263 4.96268 3.28478 4.28509 3.78494 3.78494C4.28509 3.28478 4.96268 3.00263 5.67 3H12.33C13.0373 3.00263 13.7149 3.28478 14.2151 3.78494C14.7152 4.28509 14.9974 4.96268 15 5.67V9.4H13V5.67C13 5.49231 12.9294 5.32189 12.8038 5.19624C12.6781 5.07059 12.5077 5 12.33 5H5.67C5.49231 5 5.32189 5.07059 5.19624 5.19624C5.07059 5.32189 5 5.49231 5 5.67V12.33C5 12.5077 5.07059 12.6781 5.19624 12.8038C5.32189 12.9294 5.49231 13 5.67 13H9.73V15Z" fill="#C7C7C7"></path></svg>';function O(r){var e=[];if(r.length===0)return"";if(typeof r[0]!="string")throw new TypeError("Url must be a string. Received "+r[0]);if(r[0].match(/^[^/:]+:\/*$/)&&r.length>1){var t=r.shift();r[0]=t+r[0]}r[0].match(/^file:\/\/\//)?r[0]=r[0].replace(/^([^/:]+):\/*/,"$1:///"):r[0]=r[0].replace(/^([^/:]+):\/*/,"$1://");for(var s=0;s<r.length;s++){var n=r[s];if(typeof n!="string")throw new TypeError("Url must be a string. Received "+n);n!==""&&(s>0&&(n=n.replace(/^[\/]+/,"")),s<r.length-1?n=n.replace(/[\/]+$/,""):n=n.replace(/[\/]+$/,"/"),e.push(n))}var i=e.join("/");i=i.replace(/\/(\?|&|#[^!])/g,"$1");var l=i.split("?");return i=l.shift()+(l.length>0?"?":"")+l.join("&"),i}function y(){var r;return typeof arguments[0]=="object"?r=arguments[0]:r=[].slice.call(arguments),O(r)}async function W(r){try{const e=await fetch(y("https://guessir-api.k-k.io","texts"),{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Request failed");return await e.json()}catch{throw new Error("Could not create text")}}function H(r){return`${window.location.origin}?textId=${r.id}`}function F(){return!!new URLSearchParams(window.location.search).get("textId")}function P(){const e=new URLSearchParams(window.location.search).get("textId");if(!e)throw new Error("Text ID is empty");return e}async function U(r){const e=await fetch(y("https://guessir-api.k-k.io",`texts/${r}`),{method:"GET"});if(!e.ok)throw new Error("Could not load text");return await e.json()}class M{constructor(e={}){o(this,"containerElement");o(this,"generatedUrl","");o(this,"copiedAlertElement",document.createElement("div"));o(this,"maxTitleLength",0);o(this,"maxDescriptionLength",0);o(this,"maxTextLength",0);const{maxTitleLength:t=500,maxDescriptionLength:s=4e3,maxTextLength:n=4e3}=e;this.containerElement=document.createElement("div"),this.containerElement.id="utils-container",this.maxTitleLength=t,this.maxDescriptionLength=s,this.maxTextLength=n,this.copiedAlertElement.textContent="(copied)",this.initElement()}getElement(){return this.containerElement}initElement(){this.containerElement.innerHTML=`
      <details>
        <summary>Create a new text</summary>
        <div>
          <div class="inline-flex relative">
            <input id="title-input" type="text" placeholder="Title*">
            <div class="limit-text">0/0</div>
          </div>
        </div>
        <div>
          <div class="inline-flex relative">
            <textarea rows="2" class="w-100" id="description-input" placeholder="Description"></textarea>
            <div class="limit-text">0/0</div>
          </div>
        </div>
        <div class="flex relative">
            <textarea rows="5" class="w-100" id="text-input" placeholder="Text*"></textarea>
            <div class="limit-text">0/0</div>
        </div>
        <div class="flex">
          <label>
            <input checked type="checkbox" id="allow-showing-first-letters-checkbox">Allow showing first letters
          </label>
          <br />
          <label>
            <input checked type="checkbox" id="allow-showing-text-checkbox">Allow showing text
          </label>
        </div>
        <div id="generate-url-button-container">
          <div class="relative">
            <div id="generate-url-error" class="error hide"></div>
            <button id="generate-url-button" type="button">Create</button>
          </div>
        </div>
        <div class="hide flex" id="generated-url-container">
          <button id="copy-generated-url-button" type="button">
            ${A}
          </button>
          <a href="#" id="generated-url" target="_blank">#</a>
        </div>
      </details>
    `,this.attachInputHandlers(),this.attachGenerateUrlHandler(),this.attachCopyGeneratedUrlHandler()}getElements(){return N(this.containerElement)}getValues(){const{titleInputElement:e,descriptionInputElement:t,textInputElement:s,allowShowingFirstLettersCheckboxElement:n,allowShowingTextCheckboxElement:i}=this.getElements(),l=e.value.trim(),c=t.value.trim(),a=s.value.trim(),d=n.checked,u=i.checked;return{title:l,description:c||void 0,text:a,allowShowingFirstLetters:d,allowShowingText:u}}limitInputsLength(){const{titleInputElement:e,descriptionInputElement:t,textInputElement:s}=this.getElements(),n=(i,l)=>{var d;let c=i.value.trim();c.length>l&&(c=c.substring(0,l),i.value=c);const a=(d=i.parentElement)==null?void 0:d.querySelector(".limit-text");a&&(a.innerHTML=`${c.length}/${l}`)};n(e,this.maxTitleLength),n(t,this.maxDescriptionLength),n(s,this.maxTextLength)}validateForm(e){const{titleInputElement:t,textInputElement:s}=this.getElements(),{title:n,text:i}=this.getValues(),l=!!(n&&i);return(!e||e===t)&&(n?t.classList.remove("invalid"):t.classList.add("invalid")),(!e||e===s)&&(i?s.classList.remove("invalid"):s.classList.add("invalid")),l}blockForm(e){const{titleInputElement:t,descriptionInputElement:s,textInputElement:n,allowShowingFirstLettersCheckboxElement:i,allowShowingTextCheckboxElement:l,generateUrlButtonElement:c}=this.getElements();[t,s,n,i,l,c].forEach(a=>{a.disabled=e})}cleanForm(){const{titleInputElement:e,descriptionInputElement:t,textInputElement:s,allowShowingFirstLettersCheckboxElement:n,allowShowingTextCheckboxElement:i}=this.getElements();[e,t,s].forEach(l=>{l.value=""}),[n,i].forEach(l=>{l.checked=!0})}attachInputHandlers(){const{titleInputElement:e,descriptionInputElement:t,textInputElement:s,allowShowingFirstLettersCheckboxElement:n,allowShowingTextCheckboxElement:i}=this.getElements();this.limitInputsLength(),[e,t,s].forEach(l=>{l.addEventListener("input",c=>{this.handleInputsChange(c.currentTarget)})}),[n,i].forEach(l=>{L(l,c=>{this.handleInputsChange(c.currentTarget)},{toggleChecked:!0})})}handleInputsChange(e){const{errorElement:t,generatedUrlContainerElement:s}=this.getElements();t.classList.add("hide"),s.classList.add("hide"),this.removeCopyAlert(),this.limitInputsLength(),this.validateForm(e)}attachGenerateUrlHandler(){const{generateUrlButtonElement:e,errorElement:t,generatedUrlContainerElement:s,generatedUrlElement:n}=this.getElements();e.addEventListener("click",()=>{this.validateForm()&&(this.blockForm(!0),s.classList.add("hide"),W(this.getValues()).then(i=>{this.cleanForm(),this.generatedUrl=H(i),s.classList.remove("hide"),n.textContent=this.generatedUrl,n.href=this.generatedUrl}).catch(i=>{console.error(i),t.classList.remove("hide"),t.textContent=i.message}).finally(()=>{this.blockForm(!1)}))})}removeCopyAlert(){const{copyGeneratedUrlButtonElement:e}=this.getElements();e.contains(this.copiedAlertElement)&&e.removeChild(this.copiedAlertElement)}attachCopyGeneratedUrlHandler(){const{copyGeneratedUrlButtonElement:e}=this.getElements();let t;e.addEventListener("click",()=>{navigator.clipboard.writeText(this.generatedUrl),e.appendChild(this.copiedAlertElement),t&&clearTimeout(t),t=setTimeout(()=>{this.removeCopyAlert()},5e3)})}}function N(r){const e=r.querySelector("#title-input"),t=r.querySelector("#description-input"),s=r.querySelector("#text-input"),n=r.querySelector("#allow-showing-first-letters-checkbox"),i=r.querySelector("#allow-showing-text-checkbox"),l=r.querySelector("#generate-url-button"),c=r.querySelector("#generate-url-error"),a=r.querySelector("#generated-url-container"),d=r.querySelector("#generated-url"),u=r.querySelector("#copy-generated-url-button");return{titleInputElement:e,descriptionInputElement:t,textInputElement:s,allowShowingFirstLettersCheckboxElement:n,allowShowingTextCheckboxElement:i,generateUrlButtonElement:l,errorElement:c,generatedUrlContainerElement:a,generatedUrlElement:d,copyGeneratedUrlButtonElement:u}}class D{constructor(e){o(this,"wordLikeCount",0);o(this,"score",0);o(this,"containerElement");const{wordLikeCount:t}=e;this.wordLikeCount=t,this.containerElement=document.createElement("div"),this.containerElement.id="score-container",this.initElement()}getElement(){return this.containerElement}addScore(e){this.score+=e;const{currentScoreElement:t}=this.getElements();t.textContent=this.score.toString()}initElement(){this.containerElement.innerHTML=`
      Score:&nbsp;
      <div id="current-score">${this.score}</div>
      /
      <div id="total-score">${this.wordLikeCount}</div>
    `}getElements(){return{currentScoreElement:this.containerElement.querySelector("#current-score")}}}class _{constructor(e){o(this,"lexeme");o(this,"containerElement");o(this,"userWordShowPubSub",new p);o(this,"isShown",!1);o(this,"userWordShowEvent",this.userWordShowPubSub.event);const{lexeme:t}=e;this.lexeme=t,this.containerElement=document.createElement("button"),this.containerElement.classList.add("lexeme-container"),this.initElement()}getElement(){return this.containerElement}show(){this.isShown=!0,this.containerElement.classList.add("show")}initElement(){this.containerElement.innerHTML=`
      <span class="lexeme">${this.lexeme.normalized}</span>
      <span class="lexeme-first-letter">${this.lexeme.normalized[0]}</span>
    `,this.attachClickHandler()}attachClickHandler(){this.containerElement.addEventListener("click",()=>{this.isShown||(this.show(),this.userWordShowPubSub.publish(this.lexeme))})}}class B{constructor(e){o(this,"containerElement");o(this,"lexemesAnalysis");o(this,"title");o(this,"description");o(this,"userWordShowPubSub",new p);o(this,"wordRenderers",new Map);o(this,"userWordShowEvent",this.userWordShowPubSub.event);const{lexemesAnalysis:t,title:s,description:n}=e;this.lexemesAnalysis=t,this.title=s,this.description=n,this.containerElement=document.createElement("div"),this.containerElement.id="text-container",this.initElement()}getElement(){return this.containerElement}showLexemesByWord(e){const t=this.lexemesAnalysis.lexemesByWordLike.get(e);let s=0;if(!t)return s;for(const[n]of t){const i=this.wordRenderers.get(n);if(!i)continue;const l=i.isShown;i.show(),l||s++}return s}toggleText(e){this.containerElement.classList.remove("show-text","show-first-letters"),e?this.containerElement.classList.add("show-text"):this.containerElement.classList.remove("show-text")}toggleFirstLetters(e){this.containerElement.classList.remove("show-text","show-first-letters"),e?this.containerElement.classList.add("show-first-letters"):this.containerElement.classList.remove("show-first-letters")}initElement(){this.containerElement.innerHTML=`
      <h1 id="title" class="hide"></h1>
      <p id="description" class="hide"></p>
      <div id="lexemes"></div>
    `;const{titleElement:e,descriptionElement:t,lexemesElement:s}=q(this.containerElement);this.title&&(e.classList.remove("hide"),e.textContent=this.title),this.description&&(t.classList.remove("hide"),t.textContent=this.description);for(const[n,i]of this.lexemesAnalysis.lexemes)if(h.isLexemeOtherCharacter(i))s.append(this.wrapSpecialCharacter(i));else{const l=new _({lexeme:i});l.userWordShowEvent.subscribe(c=>this.handleUserWordShow(c)),this.wordRenderers.set(n,l),s.appendChild(l.getElement())}}wrapSpecialCharacter(e){return e.normalized===`
`?document.createElement("br"):e.normalized}handleUserWordShow(e){this.userWordShowPubSub.publish(e)}}function q(r){const e=r.querySelector("#title"),t=r.querySelector("#description"),s=r.querySelector("#lexemes");return{titleElement:e,descriptionElement:t,lexemesElement:s}}class G{constructor(e){o(this,"guessirContainer");o(this,"textRenderer");o(this,"controlsRenderer");o(this,"scoreRenderer");o(this,"utilsRenderer");const{lexemesAnalysis:t,title:s,description:n,allowShowingText:i,allowShowingFirstLetters:l,textRenderer:c,controlsRenderer:a,scoreRenderer:d,createTextRenderer:u}=e;this.guessirContainer=document.createElement("div"),this.guessirContainer.id="guessir",this.textRenderer=c||new B({lexemesAnalysis:t,title:s,description:n}),this.controlsRenderer=a||new k({allowShowingText:i,allowShowingFirstLetters:l}),this.scoreRenderer=d||new D({wordLikeCount:t.wordLikeCount}),this.utilsRenderer=u||new M}init(e){e.appendChild(this.guessirContainer),this.textRenderer.userWordShowEvent.subscribe(t=>this.handleUserWordShow(t)),this.controlsRenderer.guessEvent.subscribe(t=>this.handleGuess(t)),this.controlsRenderer.showTextEvent.subscribe(t=>this.handleShowText(t)),this.controlsRenderer.showFirstLettersEvent.subscribe(t=>this.handleShowFirstLetters(t)),this.guessirContainer.appendChild(this.textRenderer.getElement()),this.guessirContainer.appendChild(this.controlsRenderer.getElement()),this.guessirContainer.appendChild(this.scoreRenderer.getElement()),this.guessirContainer.appendChild(this.utilsRenderer.getElement())}handleUserWordShow(e){this.scoreRenderer.addScore(-1)}handleGuess({word:e}){const t=this.textRenderer.showLexemesByWord(e);t?this.controlsRenderer.cleanAndFocusGuessInput():this.controlsRenderer.shakeAndError(),this.scoreRenderer.addScore(t)}handleShowText(e){this.textRenderer.toggleText(e),e&&this.scoreRenderer.addScore(-7)}handleShowFirstLetters(e){this.textRenderer.toggleFirstLetters(e),e&&this.scoreRenderer.addScore(-2)}}const Z="Hello!",$="I am a simple tool to turn any English text into a word guessing game.",V="In order to create your own text find the form below.",z=`
  I could not load the remote text. Please, verify your URL or create a new text.
`;async function j(r){let e=V,t=Z,s=$,n=!0,i=!0;if(F())try{console.log("Trying to load text...");const a=P(),d=await U(a);console.log("Text has been loaded",d),{text:e,title:t,allowShowingText:n,allowShowingFirstLetters:i,description:s}=d}catch(a){console.log("Text has been failed to load",a),console.error(a),e=z}const l=new C().analyze(e);new G({lexemesAnalysis:l,title:t,description:s,allowShowingText:n,allowShowingFirstLetters:i}).init(r)}j(document.body);
